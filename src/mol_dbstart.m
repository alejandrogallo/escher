% Copyright (C) 2011 Victor Lua~na and Alberto Otero-de-la-Roza
%
% This octave routine is free software: you can redistribute it and/or modify
% it under the terms of the GNU General Public License as published by
% the Free Software Foundation, either version 3 of the License, or (at
% your option) any later version. See <http://www.gnu.org/licenses/>.
%
% The routine distributed in the hope that it will be useful, but WITHOUT
% ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
% FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
% more details.

function mol_dbstart(color="csd",rcov="tessel",rvdw="csd")
% function mol_dbstart(color="csd",rcov="csd",rvdw="csd")
%
% mol_dbstart - initialize the database of atomic properties.
%
% Input variables:
% color: choose the color scheme. "csd" (colors from mercury, part of 
% the CSD ustilities) and "jmol" or "tessel" (tessel scheme).
% rcov: covalent radii set. "csd" (from mercury) or "tessel" (from tessel). 
% rvdw: van der waals radii set. "csd" (from mercury) or "tessel" (from tessel). 
%
% Side effect of the routine:
% atdb: database of atomic properties.
%
% Authors: VLC Victor Lua~na .......... <victor@carbono.quimica.uniovi.es>
%          AOR Alberto Otero-de-la-Roza <alberto@carbono.quimica.uniovi.es>
% Created: June 2011

   global atdb

   ## atomic symbols
   atdb.symbols = {...
      "H" , "HE", "LI", "BE", "B" , "C" , "N" , "O" , "F" , "NE", ...
      "NA", "MG", "AL", "SI", "P" , "S" , "CL", "AR", "K" , "CA", ...
      "SC", "TI", "V" , "CR", "MN", "FE", "CO", "NI", "CU", "ZN", ...
      "GA", "GE", "AS", "SE", "BR", "KR", "RB", "SR", "Y" , "ZR", ...
      "NB", "MO", "TC", "RU", "RH", "PD", "AG", "CD", "IN", "SN", ...
      "SB", "TE", "I" , "XE", "CS", "BA", "LA", "CE", "PR", "ND", ...
      "PM", "SM", "EU", "GD", "TB", "DY", "HO", "ER", "TM", "YB", ...
      "LU", "HF", "TA", "W" , "RE", "OS", "IR", "PT", "AU", "HG", ...
      "TL", "PB", "BI", "PO", "AT", "RN", "FR", "RA", "AC", "TH", ...
      "PA", "U" , "NP", "PU", "AM", "CM", "BK", "CF", "ES", "FM", ...
      "MD", "NO", "LR", "X", ...
      "N@", "B@", "R@", "C@" ...
      };

   ## covalent radii
   atdb.rcov_tessel = [ ... ## from tessel
       53,  70,  68,  35,  83,  68,  68,  68,  64,  70, ...
       97, 110, 135, 120, 105, 102,  99,  70, 133,  99, ...
      144, 147, 133, 135, 135, 134, 133, 150, 152, 145, ...
      122, 117, 121, 122, 121, 191, 147, 112, 178, 157, ...
      148, 147, 135, 140, 145, 150, 159, 169, 163, 146, ...
      146, 147, 140, 198, 167, 134, 187, 183, 182, 181, ...
      180, 180, 199, 179, 176, 175, 174, 173, 172, 194, ...
      172, 157, 143, 137, 135, 137, 132, 150, 150, 170, ...
      155, 154, 154, 168, 170, 240, 200, 190, 188, 179, ...
      161, 158, 155, 153, 151, 151, 151, 151, 151, 151, ...
      151, 151, 151,  25,...
       25,  25,  25,  25 ...
      ] / 100;
   atdb.rcov_csd = [ ... ## from CSD
      0.23, 1.50, 1.28, 0.96, 0.83, 0.68, 0.68, 0.68, 0.64, 1.50, ...
      1.66, 1.41, 1.21, 1.20, 1.05, 1.02, 0.99, 1.51, 2.03, 1.76, ...
      1.70, 1.60, 1.53, 1.39, 1.61, 1.52, 1.26, 1.24, 1.32, 1.22, ...
      1.22, 1.17, 1.21, 1.22, 1.21, 1.50, 2.20, 1.95, 1.90, 1.75, ...
      1.64, 1.54, 1.47, 1.46, 1.42, 1.39, 1.45, 1.54, 1.42, 1.39, ...
      1.39, 1.47, 1.40, 1.50, 2.44, 2.15, 2.07, 2.04, 2.03, 2.01, ...
      1.99, 1.98, 1.98, 1.96, 1.94, 1.92, 1.92, 1.89, 1.90, 1.87, ...
      1.87, 1.75, 1.70, 1.62, 1.51, 1.44, 1.41, 1.36, 1.36, 1.32, ...
      1.45, 1.46, 1.48, 1.40, 1.21, 1.50, 2.60, 2.21, 2.15, 2.06, ...
      2.00, 1.96, 1.90, 1.87, 1.80, 1.69, 1.54, 1.83, 1.50, 1.50, ...
      1.50, 1.50, 1.50, 1.50, 1.50, 1.50, 1.50, 1.50, 1.50, 1.50];
   if (strcmp(rcov,"csd"))
     atdb.rcov = atdb.rcov_csd;
   elseif (strcmp(rcov,"tessel"))
     atdb.rcov = atdb.rcov_tessel;
   else
     error("Unknown covalent radii set")
   endif

   ## van der waals radii
   atdb.rvdw_tessel = [ ... ## from tessel
      120, 122, 152, 170, 208, 185, 184, 140, 135, 160, ...
      231, 170, 205, 200, 190, 185, 181, 191, 231, 197, ...
      170, 170, 170, 170, 170, 170, 170, 170, 170, 170, ...
      170, 170, 200, 200, 210, 170, 170, 170, 170, 170, ...
      170, 170, 170, 170, 170, 170, 170, 170, 170, 170, ...
      220, 220, 215, 170, 170, 170, 170, 170, 170, 170, ...
      170, 170, 170, 170, 170, 170, 170, 170, 170, 170, ...
      170, 170, 170, 170, 170, 170, 170, 170, 170, 170, ...
      170, 170, 170, 170, 170, 170, 170, 170, 170, 170, ...
      170, 170, 170, 170, 170, 170, 170, 170, 170, 170, ...
      170, 170, 170, 170, 170, 170, 170, 170, 170, 170, ...
      170, 170, 170, 170, 170, 170, 170, 170, 170, 170] / 100;
   atdb.rvdw_csd = [ ... ## from CSD
      1.09, 1.40, 1.82, 2.00, 2.00, 1.70, 1.55, 1.52, 1.47, 1.54, ...
      2.27, 1.73, 2.00, 2.10, 1.80, 1.80, 1.75, 1.88, 2.75, 2.00, ...
      2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 1.63, 1.40, 1.39, ...
      1.87, 2.00, 1.85, 1.90, 1.85, 2.02, 2.00, 2.00, 2.00, 2.00, ...
      2.00, 2.00, 2.00, 2.00, 2.00, 1.63, 1.72, 1.58, 1.93, 2.17, ...
      2.00, 2.06, 1.98, 2.16, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, ...
      2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, ...
      2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 1.72, 1.66, 1.55, ...
      1.96, 2.02, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, ...
      2.00, 1.86, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, ...
      2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00, 2.00];
   atdb.rvdw = atdb.rvdw_tessel;
   if (strcmp(rvdw,"csd"))
     atdb.rvdw = atdb.rvdw_csd;
   elseif (strcmp(rvdw,"tessel"))
     atdb.rvdw = atdb.rvdw_tessel;
   else
     error("Unknown van der Waals radii set")
   endif

   ## atomic masses
   atdb.mass = [ ...
   1.0079,    4.00260,   6.941,     9.01218,  10.81,     12.011,  14.0067,  15.9994,  18.998403  20.179, ...
  22.98977,  24.305,    26.98154,  28.0855,   30.97376,  32.06,   35.453,   39.948,   39.0983,   40.08, ...
  44.9559,   47.90,     50.9415,   51.996,    54.9380,   55.847,  58.9332,  58.70,    63.546,    65.38, ...
  69.72,     72.59,     74.9216,   78.96,     79.904,    83.80,   85.4678,  87.62,    88.9059,   91.22, ...
  92.9064,   95.94,     98.,      101.07,    102.9055,  106.4,   107.868,  112.41,   114.82,    118.69, ...
 121.75,    127.60,    126.9045,  131.30,    132.9054,  137.33,  138.9055, 140.12,   140.9077,  144.24, ...
 145.,      150.4,     151.96,    157.25,    158.9254,  162.50,  164.9304, 167.26,   168.9342,  173.04, ...
 174.967,   178.49,    180.9479,  183.85,    186.207,   190.2,   192.22,   195.09,   196.9665,  200.59, ...
 204.37,    207.2,     208.9804,  209.,      210.,      222.,    223.,     226.0254, 227.0278,  232.0381, ...
 231.0359,  238.029,   237.0482,  244.,      243.,      247.,    247.,     251.,     252.,      257., ...
 255.,      255.,      260.,        0.,...
     0.,      0.,        0.,        0. ...
     ];

   ## atomic colors
   atdb.jmol_color = [ ... # modified from tessel, jmol colors (http://jmol.sourceforge.net/jscolors/)
       225,225,225, 217,255,255, 204,128,255,... #001-003 H,  He, Li
       194,255,000, 255,181,181,  25, 25, 25,... #004-006 Be, B,  C
       048,080,248, 255,013,013, 144,224,080,... #007-009 N,  O,  F
       179,227,245, 171,092,242, 138,255,000,... #010-012 Ne, Na, Mg
       191,166,166, 240,200,160, 255,128,000,... #013-015 Al, Si, P
       255,255,048, 031,240,031, 128,209,227,... #016,018 S,  Cl, Ar
       143,064,212, 061,000,255, 230,230,230,... #019-021 K,  Ca, Sc
       191,194,199, 166,166,171, 138,153,199,... #022-024 Ti, V,  Cr
       156,122,199, 224,102,051, 240,144,160,... #025-027 Mn, Fe, Co
       080,208,080, 200,128,051, 125,128,176,... #028-030 Ni, Cu, Zn
       194,143,143, 102,143,143, 189,128,227,... #031-033 Ga, Ge, As
       255,161,000, 166,041,041, 092,184,209,... #034-036 Se, Br, Kr
       112,046,176, 000,255,000, 148,255,255,... #037-039 Rb, Sr, Y
       148,224,224, 115,194,201, 084,181,181,... #040-042 Zr, Nb, Mo
       059,158,158, 036,143,143, 010,125,140,... #043-045 Tc, Ru, Rh
       000,105,133, 192,192,192, 255,217,143,... #046-048 Pd, Ag, Cd
       166,117,115, 102,128,128, 158,099,181,... #049-051 In, Sn, Sb
       212,122,000, 148,000,148, 066,158,176,... #052-054 Te, I,  Xe
       087,023,143, 000,201,000, 112,212,255,... #055-057 Cs, Ba, La
       255,255,199, 217,255,199, 199,255,199,... #058-060 Ce, Pr, Nd
       163,255,199, 143,255,199, 097,255,199,... #061-063 Pm, Sm, Eu
       069,255,199, 048,255,199, 031,255,199,... #064-066 Gd, Tb, Dy
       000,255,156, 000,230,117, 000,212,082,... #067-069 Ho, Er, Tm
       000,191,056, 000,171,036, 077,194,255,... #070-072 Yb, Lu, Hf
       077,166,255, 033,148,214, 038,125,171,... #073-075 Ta, W,  Re
       038,102,150, 023,084,135, 208,208,224,... #076-078 Os, Ir, Pt
       255,209,035, 184,184,208, 166,084,077,... #079-081 Au, Hg, Tl
       087,089,097, 158,079,181, 171,092,000,... #082-084 Pb, Bi, Po
       117,079,069, 066,130,150, 066,000,102,... #085-087 At, Rn, Fr
       000,125,000, 112,171,250, 000,186,255,... #088-090 Ra, Ac, Th
       000,161,255, 000,143,255, 000,128,255,... #091-093 Pa, U,  Np
       000,107,255, 084,092,242, 120,092,227,... #094-096 Pu, Am, Cm
       138,079,227, 161,054,212, 179,031,212,... #097-099 Bk, Cf, Es
       179,031,186, 179,013,166, 189,013,135,... #100-102 Fm, Md, No
       199,000,102, 204,000,089, 000,217,000,... #103-105 Lr,  X, N@
       217,000,069, 000,000,217, 025,025,025,... #106-108 B@, R@, C@
       235,000,038, 160,000,066, 015,130,015,... #109-111 Mt, XX, YY
       020,090,255, 200,000,200, 255,180,070,... #112-114 ZZ, XY, XZ
       000,220,220, 230,010,010, 140,255,140,... #115-117 YX, YZ, ZX
       112,112,255, 127,050,000, 127,000,050 ... #118-120 ZY, TT, WW
                 ];
   atdb.csd_color = [ ... # from mercury (CSD) except H and C (jmol)
       225,225,225, 217,255,255, 204,128,255,... #001-003 H,  He, Li
       194,255,000, 255,181,181, 025,025,025,... #004-006 Be, B,  C
       143,143,255, 240,000,000, 194,255,000,... #007-009 N,  O,  F
       173,227,242, 171,092,242, 135,255,000,... #010-012 Ne, Na, Mg
       207,166,166, 209,214,140, 255,128,000,... #013-015 Al, Si, P
       255,199,048, 031,240,031, 128,209,229,... #016,018 S,  Cl, Ar
       140,064,212, 059,255,000, 230,230,230,... #019-021 K,  Ca, Sc
       191,194,199, 166,166,171, 138,153,199,... #022-024 Ti, V,  Cr
       156,122,199, 229,077,000, 077,051,204,... #025-027 Mn, Fe, Co
       000,204,102, 204,077,026, 125,128,176,... #028-030 Ni, Cu, Zn
       194,143,143, 102,143,143, 189,128,227,... #031-033 Ga, Ge, As
       255,161,000, 190,130,060, 092,184,209,... #034-036 Se, Br, Kr
       112,046,176, 000,255,000, 148,255,255,... #037-039 Rb, Sr, Y
       148,224,224, 115,194,201, 084,181,181,... #040-042 Zr, Nb, Mo
       059,158,158, 036,143,143, 010,125,140,... #043-045 Tc, Ru, Rh
       000,105,133, 192,192,192, 255,217,143,... #046-048 Pd, Ag, Cd
       166,117,115, 102,128,128, 158,099,181,... #049-051 In, Sn, Sb
       212,122,000, 153,000,153, 066,158,176,... #052-054 Te, I,  Xe
       087,023,143, 000,201,000, 112,212,255,... #055-057 Cs, Ba, La
       255,255,199, 217,255,199, 199,255,199,... #058-060 Ce, Pr, Nd
       163,255,199, 143,255,199, 097,255,199,... #061-063 Pm, Sm, Eu
       069,255,199, 048,255,199, 031,255,199,... #064-066 Gd, Tb, Dy
       000,255,156, 000,230,117, 000,212,082,... #067-069 Ho, Er, Tm
       000,191,056, 000,171,036, 077,194,255,... #070-072 Yb, Lu, Hf
       077,166,255, 033,148,214, 038,125,171,... #073-075 Ta, W,  Re
       038,102,150, 023,084,135, 208,208,224,... #076-078 Os, Ir, Pt
       255,209,035, 184,184,208, 166,084,077,... #079-081 Au, Hg, Tl
       087,089,097, 158,079,181, 171,092,000,... #082-084 Pb, Bi, Po
       117,079,069, 066,130,150, 066,000,102,... #085-087 At, Rn, Fr
       000,125,000, 112,171,250, 000,186,255,... #088-090 Ra, Ac, Th
       000,161,255, 000,143,255, 000,128,255,... #091-093 Pa, U,  Np
       000,107,255, 084,092,242, 120,092,227,... #094-096 Pu, Am, Cm
       138,079,227, 161,054,212, 179,031,212,... #097-099 Bk, Cf, Es
       179,031,186, 179,013,166, 189,013,135,... #100-102 Fm, Md, No
       199,000,102, 204,000,089, 000,217,000,... #103-105 Lr,  X, N@
       217,000,069, 000,000,217, 025,025,025,... #106-108 B@, R@, C@
       235,000,038, 160,000,066, 015,130,015,... #109-111 Mt, XX, YY
       020,090,255, 200,000,200, 255,180,070,... #112-114 ZZ, XY, XZ
       000,220,220, 230,010,010, 140,255,140,... #115-117 YX, YZ, ZX
       112,112,255, 127,050,000, 127,000,050 ... #118-120 ZY, TT, WW
                     ];
   if (strcmp(color,"csd"))
     atdb.color = reshape(atdb.csd_color,3,120);
   elseif (strcmp(color,"jmol") || strcmp(color,"tessel"))
     atdb.color = reshape(atdb.jmol_color,3,120);
   else
     error("Unknown color set")
   endif


endfunction
